function claimVoucher(offId, loyId, massCode) {
    const slug = "2le1hb5pjyoo9"; 
    const partner = "Tiktok Live 109.5";

    const queryParams = new URLSearchParams({
        offer_id: offId,
        loyalty_id: loyId,
        code: massCode,
        partner: partner,
        is_mass_code: "1"
    }).toString();

    const finalTarget = `https://smart.link/${slug}?${queryParams}`;
    const deepLink = `gmalite://gmalite-smartweb?weburl=${encodeURIComponent(finalTarget)}`;

    // PERBAIKAN: Jangan pakai window.location.replace secara otomatis
    // Gunakan lokasi langsung pada window utama saat ini
    window.top.location.href = deepLink;

    // Fallback: Jika setelah 3 detik masih di browser, berarti aplikasi tidak terbuka
    setTimeout(function() {
        if (!document.hidden) {
            // Arahkan ke Play Store atau Web resmi agar tidak 'about:blank'
            window.location.href = "https://www.mcdonalds.co.id/promo";
        }
    }, 3000);
}
